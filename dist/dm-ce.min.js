!function(t){var e={};function r(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,r){var a=r(1),i=r(2);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var n={insert:"head",singleton:!1},o=(a(i,n),i.locals?i.locals:{});t.exports=o},function(t,e,r){"use strict";var a,i=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},n=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),o=[];function s(t){for(var e=-1,r=0;r<o.length;r++)if(o[r].identifier===t){e=r;break}return e}function l(t,e){for(var r={},a=[],i=0;i<t.length;i++){var n=t[i],l=e.base?n[0]+e.base:n[0],d=r[l]||0,c="".concat(l," ").concat(d);r[l]=d+1;var u=s(c),p={css:n[1],media:n[2],sourceMap:n[3]};-1!==u?(o[u].references++,o[u].updater(p)):o.push({identifier:c,updater:y(p,e),references:1}),a.push(c)}return a}function d(t){var e=document.createElement("style"),a=t.attributes||{};if(void 0===a.nonce){var i=r.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(t){e.setAttribute(t,a[t])})),"function"==typeof t.insert)t.insert(e);else{var o=n(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var c,u=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function p(t,e,r,a){var i=r?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(t.styleSheet)t.styleSheet.cssText=u(e,i);else{var n=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(n,o[e]):t.appendChild(n)}}function m(t,e,r){var a=r.css,i=r.media,n=r.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),n&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleSheet)t.styleSheet.cssText=a;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(a))}}var h=null,f=0;function y(t,e){var r,a,i;if(e.singleton){var n=f++;r=h||(h=d(e)),a=p.bind(null,r,n,!1),i=p.bind(null,r,n,!0)}else r=d(e),a=m.bind(null,r,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return a(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;a(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var r=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var a=0;a<r.length;a++){var i=s(r[a]);o[i].references--}for(var n=l(t,e),d=0;d<r.length;d++){var c=s(r[d]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}r=n}}}},function(t,e,r){(e=r(3)(!1)).push([t.i,'.dailymotion-cpe:before{content:"";padding-top:56.25%;background:#000;display:block;-webkit-animation:slideInDown;animation:slideInDown;-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-iteration-count:1;animation-iteration-count:1}@-webkit-keyframes slideInDown{from{padding-top:0}to{padding-top:56.25%}}@keyframes slideInDown{from{padding-top:0}to{padding-top:56.25%}}.dm__pre-video-title{text-align:var(--dm-video-align, center) !important;margin:var(--dm-video-margin, 8px 0) !important;font-style:var(--dm-video-style, normal) !important;color:var(--dm-video-color, #000) !important;font-size:var(--dm-video-size, 1.2em) !important;font-weight:var(--dm-video-weight, 700) !important}.dm__info-card{background:var(--dm-info-card-bg, #ddd) !important;padding:var(--dm-info-card-padding, 8px 13px) !important;display:flex;text-align:var(--dm-info-card-align, left) !important;--dm-title-align: left;--dm-title-weight: 700;--dm-title-size: 1.1em}.dm__text-wrapper{width:calc(100% - 78px);padding-right:13px}.dm__video-title{text-align:var(--dm-title-align, center) !important;margin:var(--dm-title-margin, 8px 0) !important;font-style:var(--dm-title-style, normal) !important;color:var(--dm-title-color, inherit) !important;font-size:var(--dm-title-size, 1em) !important;font-weight:var(--dm-title-weight, 400) !important;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:100%}.dm__video-desc{text-align:var(--dm-desc-align, left) !important;margin:var(--dm-desc-margin, 0 0 8px) !important;font-style:var(--dm-desc-style, normal) !important;color:var(--dm-desc-color, inherit) !important;font-size:var(--dm-desc-size, 0.9em) !important;font-weight:var(--dm-desc-weight, inherit) !important;padding-top:13px;border-top:solid #666 1px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:100%;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.dm__owner-ava{width:65px;height:auto}\n',""]),t.exports=e},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",a=t[3];if(!a)return r;if(e&&"function"==typeof btoa){var i=(o=a,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),n=a.sources.map((function(t){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(t," */")}));return[r].concat(n).concat([i]).join("\n")}var o,s,l;return[r].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,a){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(a)for(var n=0;n<this.length;n++){var o=this[n][0];null!=o&&(i[o]=!0)}for(var s=0;s<t.length;s++){var l=[].concat(t[s]);a&&i[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),e.push(l))}},e}},function(t,e,r){"use strict";function a(t){return new URLSearchParams(window.location.search).get(t)}r.r(e);r(0),new(function(){function t(t){this.rootEls=null,this.playerParams=null,this.searchParams=null,this.videoParams=null,this.debugMode=!1,this.rootEls=t,null!=a("dmdebug")&&(this.debugMode="false"!=a("dmdebug")),this.addEventListeners(),this.registerNewEvents(),this.extractAttrs()}return t.prototype.addEventListeners=function(){var t=this;document.addEventListener("dm-api-ready",(function(e){t.loadDmPlayer()})),document.addEventListener("dm-player-extracted",(function(e){t.prepareSearchParams()})),document.addEventListener("dm-search-params-ready",(function(e){t.searchVideo()}))},t.prototype.registerNewEvents=function(){this.apiReady=new Event("dm-api-ready"),this.playerExtracted=new Event("dm-player-extracted"),this.searchParamsReady=new Event("dm-search-params-ready")},t.prototype.extractAttrs=function(){var t=this.rootEls[0];this.playerParams={maxWordSearch:t.getAttribute("maxWordSearch")?Number(t.getAttribute("maxWordSearch")):15,minWordLength:t.getAttribute("minWordLength")?Number(t.getAttribute("minWordLength")):4,minWordSearch:t.getAttribute("minWordSearch")?Number(t.getAttribute("minWordSearch")):2,language:t.getAttribute("language")?t.getAttribute("language"):"",sort:t.getAttribute("sort")?t.getAttribute("sort"):"recent",owners:t.getAttribute("owners")?t.getAttribute("owners"):"",category:t.getAttribute("category")?t.getAttribute("category"):"",excludeIds:t.getAttribute("excludeIds")?t.getAttribute("excludeIds"):"",searchInPlaylist:!!t.getAttribute("searchInPlaylist")&&t.getAttribute("searchInPlaylist"),syndication:t.getAttribute("syndication")?t.getAttribute("syndication"):"",controls:"false"!=t.getAttribute("controls"),adsParams:t.getAttribute("adsParams")?t.getAttribute("adsParams"):"contextual",cpeId:t.getAttribute("cpeId")?t.getAttribute("cpeId").split(","):[""],keywordsSelector:t.getAttribute("keywordsSelector")?t.getAttribute("keywordsSelector"):null,preVideoTitle:t.getAttribute("preVideoTitle")?t.getAttribute("preVideoTitle"):null,showVideoTitle:"false"!=t.getAttribute("showVideoTitle")&&null!=t.getAttribute("showVideoTitle"),showInfoCard:"false"!=t.getAttribute("showInfoCard")&&null!=t.getAttribute("showInfoCard"),autoPlayMute:"false"!=t.getAttribute("autoPlayMute"),queueEnable:"false"!=t.getAttribute("queueEnable"),queueEnableNext:"false"!=t.getAttribute("queueEnableNext"),pipAtStart:"false"!=t.getAttribute("pipAtStart")&&null!=t.getAttribute("pipAtStart"),noStp:"false"!=t.getAttribute("noStp")&&null!=t.getAttribute("noStp"),noPip:"false"!=t.getAttribute("noPip")&&null!=t.getAttribute("noPip"),scrollToPause:"false"!=t.getAttribute("scrollToPause")&&null!=t.getAttribute("scrollToPause"),stpSound:"false"!=t.getAttribute("stpSound")&&null!=t.getAttribute("stpSound"),playerStyleEnable:"false"!=t.getAttribute("playerStyleEnable")&&null!=t.getAttribute("playerStyleEnable"),playerStyleColor:t.getAttribute("playerStyleColor")?t.getAttribute("playerStyleColor"):null},!0===this.debugMode&&console.log("%c DM Player Params: ","background: #56C7FF; color: #232323",this.playerParams),document.dispatchEvent(this.playerExtracted)},t.prototype.prepareSearchParams=function(){var t=this.findKeywords(this.playerParams.keywordsSelector);this.searchParams={fields:this.playerParams.showInfoCard?"id,title,description,owner.avatar_190_url":"id,title",limit:1,sort:this.playerParams.sort},"relevance"===this.playerParams.sort&&(this.searchParams.search=t?t.sort((function(t,e){return e.length-t.length})).slice(0,this.playerParams.maxWordSearch).join(" "):""),this.playerParams.searchInPlaylist||(this.searchParams.private=0,this.searchParams.flags="no_live,exportable"+(this.playerParams.owners.length>0?"":",verified"),this.searchParams.longer_than=.35,this.playerParams.owners&&(this.searchParams.owners=this.playerParams.owners),this.playerParams.category&&(this.searchParams.channel=this.playerParams.category),this.playerParams.excludeIds&&(this.searchParams.exclude_ids=this.playerParams.excludeIds)),this.playerParams.language&&(this.searchParams.language=this.playerParams.language),document.dispatchEvent(this.searchParamsReady)},t.prototype.htmlEntities=function(t){return String(t).replace(/&/g,"%26").replace(/=/g,"%3d")},t.prototype.loadDmPlayer=function(){var t=this.rootEls[0],e=document.createElement("div"),r="";""===this.playerParams.adsParams?r+="ads_params=contextual":r+="ads_params="+this.htmlEntities(this.playerParams.adsParams),""!==this.playerParams.syndication&&(r+="&syndication="+this.playerParams.syndication),!0!==this.playerParams.controls&&(r+="&controls="+this.playerParams.controls),e.setAttribute("class","dailymotion-cpe"),e.setAttribute("video-id",this.videoParams.id),e.setAttribute("query-string",r),!0===this.playerParams.pipAtStart&&e.setAttribute("pip-at-start",""),!0===this.playerParams.noStp&&e.setAttribute("no-stp",""),!0===this.playerParams.noPip&&e.setAttribute("no-pip",""),!1===this.playerParams.queueEnable&&e.setAttribute("no-queue",""),!1===this.playerParams.queueEnableNext&&e.setAttribute("no-autonext",""),!1!==this.playerParams.searchInPlaylist&&e.setAttribute("Playlist-id",this.playerParams.searchInPlaylist),null!==t.getAttribute("width")&&(this.playerParams.width=Number(t.getAttribute("width")),e.setAttribute("width",t.getAttribute("width"))),null!==t.getAttribute("height")&&(this.playerParams.height=Number(t.getAttribute("height")),e.setAttribute("height",t.getAttribute("height")));var a=this.playerParams.cpeId[0];/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(a=this.playerParams.cpeId[1]?this.playerParams.cpeId[1]:this.playerParams.cpeId[0]);var i={};!0===this.playerParams.scrollToPause&&(i.scroll_to_pause=!0),!0===this.playerParams.stpSound&&(i.stp_sound=!0),!0===this.playerParams.playerStyleEnable&&(i.player_style_enable=!0),null!==this.playerParams.playerStyleColor&&(i.player_style_color=this.playerParams.playerStyleColor);var n,o,s,l,d,c,u,p,m=new Date;if(null!==this.playerParams.preVideoTitle){var h=this.setPreVideoTitle(this.playerParams.preVideoTitle);t.appendChild(h)}if(t.appendChild(e),n=window,o=document,s="script",l="cpe",d=a,c=i,n.WDMObject=l,n[l]=n[l]||function(){(n[l].q=n[l].q||[]).push(arguments)},n[l].l=1*m,n[l].i=d,n[l].f=c,n[l].g=void 0,(u=o.createElement(s)).async=1,u.src="//api.dmcdn.net/pxl/cpe/client.min.js",(p=o.getElementsByTagName(s)[0]).parentNode.insertBefore(u,p),!0===this.playerParams.showVideoTitle){var f=this.setVideoTitle(this.videoParams.title);t.appendChild(f)}if(!0===this.playerParams.showInfoCard){var y=this.setInfoCard(this.videoParams);t.appendChild(y)}},t.prototype.setVideo=function(t){this.videoParams=t,document.dispatchEvent(this.apiReady)},t.prototype.setPreVideoTitle=function(t){var e=document.createElement("p");return e.innerHTML=t,e.className="dm__pre-video-title",e},t.prototype.setVideoTitle=function(t){var e=document.createElement("p");return e.innerHTML=t,e.className="dm__video-title",e},t.prototype.setInfoCard=function(t){var e=document.createElement("div");e.className="dm__info-card";var r=document.createElement("div");r.className="dm__text-wrapper";var a=document.createElement("p");a.innerHTML=t.title,a.className="dm__video-title";var i=document.createElement("p");i.innerHTML=t.description,i.className="dm__video-desc",r.append(a),r.append(i);var n=document.createElement("img");return n.src=t["owner.avatar_190_url"],n.className="dm__owner-ava",e.append(r),e.append(n),e},t.prototype.searchVideo=function(){var t=this;!0===this.debugMode&&console.log("%c DM related ","background: #56C7FF; color: #232323","Search: "+this.searchParams.search);var e=Object.entries(this.searchParams).map((function(t){var e=t[0],r=t[1];return encodeURIComponent(e)+"="+encodeURIComponent(r)})).join("&"),r="https://api.dailymotion.com/"+(this.playerParams.searchInPlaylist?"playlist/"+this.playerParams.searchInPlaylist+"/videos":"videos")+"?"+e;fetch(r).then((function(t){return t.json()})).then((function(e){e.total>0?t.setVideo(e.list[0]):(!0===t.debugMode&&console.log("%c DM related ","background: #56C7FF; color: #232323","Can not find related video. Fallback video used."),t.getFallbackVideo())}))},t.prototype.getFallbackVideo=function(){var t=this,e=Math.floor(Date.now()/1e3),r="https://api.dailymotion.com/"+(this.playerParams.searchInPlaylist?"playlist/"+this.playerParams.searchInPlaylist+"/videos?":"videos?owners="+this.playerParams.owners)+"&created_after="+(e-2592e3)+"&sort=random&limit=1&fields="+this.searchParams.fields,a=this;fetch(r).then((function(t){return t.json()})).then((function(e){e.list.length>0?a.setVideo(e.list[0]):!0===t.debugMode&&console.warn("DM related Unable to find a fallback video")}))},t.prototype.videoEvents=function(){window.addEventListener("cpeready",(function(t){t.detail.players[0]}))},t.prototype.findKeywords=function(t){var e=[""];if(null!==t){var r=document.querySelector(t);e=this.sanitizeKeywords(r.getAttribute("content"))}else null===t&&void 0!==document.getElementsByTagName("h1")[0]&&(e=this.sanitizeKeywords(document.getElementsByTagName("h1")[0].textContent));return e},t.prototype.sanitizeKeywords=function(t){var e=this;return t.replace(/[^- \u3131-\uD79D a-zA-Z0-9 \u00C0-\u00FF \u0900-\u097F \u0153]/g," ").split(" ").filter((function(t){return t.length>=e.playerParams.minWordLength}))},t}())(document.querySelectorAll(".dm-player"))}]);
//# sourceMappingURL=dm-ce.min.js.map