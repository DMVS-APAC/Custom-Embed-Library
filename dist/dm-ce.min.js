!function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){var a=r(1),n=r(2);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1},o=(a(n,i),n.locals?n.locals:{});e.exports=o},function(e,t,r){"use strict";var a,n=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},i=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),o=[];function s(e){for(var t=-1,r=0;r<o.length;r++)if(o[r].identifier===e){t=r;break}return t}function l(e,t){for(var r={},a=[],n=0;n<e.length;n++){var i=e[n],l=t.base?i[0]+t.base:i[0],c=r[l]||0,u="".concat(l," ").concat(c);r[l]=c+1;var d=s(u),p={css:i[1],media:i[2],sourceMap:i[3]};-1!==d?(o[d].references++,o[d].updater(p)):o.push({identifier:u,updater:y(p,t),references:1}),a.push(u)}return a}function c(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var n=r.nc;n&&(a.nonce=n)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,d=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function p(e,t,r,a){var n=r?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=d(t,n);else{var i=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function m(e,t,r){var a=r.css,n=r.media,i=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var h=null,f=0;function y(e,t){var r,a,n;if(t.singleton){var i=f++;r=h||(h=c(t)),a=p.bind(null,r,i,!1),n=p.bind(null,r,i,!0)}else r=c(t),a=m.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var r=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<r.length;a++){var n=s(r[a]);o[n].references--}for(var i=l(e,t),c=0;c<r.length;c++){var u=s(r[c]);0===o[u].references&&(o[u].updater(),o.splice(u,1))}r=i}}}},function(e,t,r){(t=r(3)(!1)).push([e.i,'.dailymotion-cpe:before{content:"";padding-top:56.25%;background:#000;display:block;-webkit-animation:slideInDown;animation:slideInDown;-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-iteration-count:1;animation-iteration-count:1}@-webkit-keyframes slideInDown{from{padding-top:0}to{padding-top:56.25%}}@keyframes slideInDown{from{padding-top:0}to{padding-top:56.25%}}.dm__pre-video-title{text-align:var(--dm-video-align, center) !important;margin:var(--dm-video-margin, 8px 0) !important;font-style:var(--dm-video-style, normal) !important;color:var(--dm-video-color, #000) !important;font-size:var(--dm-video-size, 1.2em) !important;font-weight:var(--dm-video-weight, 700) !important}.dm__info-card{background:var(--dm-info-card-bg, #eee) !important;padding:var(--dm-info-card-padding, 8px 13px) !important;display:flex;text-align:var(--dm-info-card-align, left) !important;--dm-title-align: left;--dm-title-weight: 700;--dm-title-size: 1.1em}.dm__text-wrapper{width:88%;padding-right:13px}.dm__video-title{text-align:var(--dm-title-align, center) !important;margin:var(--dm-title-margin, 8px 0) !important;font-style:var(--dm-title-style, normal) !important;color:var(--dm-title-color, inherit) !important;font-size:var(--dm-title-size, 1em) !important;font-weight:var(--dm-title-weight, 400) !important;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:100%}.dm__video-desc{text-align:var(--dm-desc-align, left) !important;margin:var(--dm-desc-margin, 0 0 8px) !important;font-style:var(--dm-desc-style, normal) !important;color:var(--dm-desc-color, inherit) !important;font-size:var(--dm-desc-size, 0.9em) !important;font-weight:var(--dm-desc-weight, inherit) !important;padding-top:13px;border-top:solid #666 1px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:100%;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.dm__owner-ava{width:10%;height:auto}\n',""]),e.exports=t},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",a=e[3];if(!a)return r;if(t&&"function"==typeof btoa){var n=(o=a,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),i=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[r].concat(i).concat([n]).join("\n")}var o,s,l;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(n[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},function(e,t,r){"use strict";function a(e){return new URLSearchParams(window.location.search).get(e)}r.r(t);r(0);var n=function(){function e(e){this.rootEls=null,this.playerParams=null,this.searchParams=null,this.videoParams=null,this.debugMode=!1,this.rootEls=e,null!=a("dmdebug")&&(this.debugMode="false"!=a("dmdebug")),this.addEventListeners(),this.registerNewEvents(),this.extractAttrs()}return e.prototype.addEventListeners=function(){var e=this;document.addEventListener("dm-api-ready",(function(t){e.loadDmPlayer()})),document.addEventListener("dm-player-extracted",(function(t){e.prepareSearchParams()})),document.addEventListener("dm-search-params-ready",(function(t){e.searchVideo()}))},e.prototype.registerNewEvents=function(){this.apiReady=new Event("dm-api-ready"),this.playerExtracted=new Event("dm-player-extracted"),this.searchParamsReady=new Event("dm-search-params-ready")},e.prototype.extractAttrs=function(){var e=this.rootEls[0];this.playerParams={maxWordSearch:e.getAttribute("maxWordSearch")?Number(e.getAttribute("maxWordSearch")):15,minWordLength:e.getAttribute("minWordLength")?Number(e.getAttribute("minWordLength")):4,minWordSearch:e.getAttribute("minWordSearch")?Number(e.getAttribute("minWordSearch")):2,language:e.getAttribute("language")?e.getAttribute("language"):"",sort:e.getAttribute("sort")?e.getAttribute("sort"):"recent",owners:e.getAttribute("owners")?e.getAttribute("owners"):"",category:e.getAttribute("category")?e.getAttribute("category"):"",excludeIds:e.getAttribute("excludeIds")?e.getAttribute("excludeIds"):"",searchInPlaylist:!!e.getAttribute("searchInPlaylist")&&e.getAttribute("searchInPlaylist"),syndication:e.getAttribute("syndication")?e.getAttribute("syndication"):"",controls:"false"!=e.getAttribute("controls"),adsParams:e.getAttribute("adsParams")?e.getAttribute("adsParams"):"contextual",cpeId:e.getAttribute("cpeId")?e.getAttribute("cpeId").split(","):[""],keywordsSelector:e.getAttribute("keywordsSelector")?e.getAttribute("keywordsSelector"):null,preVideoTitle:e.getAttribute("preVideoTitle")?e.getAttribute("preVideoTitle"):null,showVideoTitle:"false"!=e.getAttribute("showVideoTitle")&&null!=e.getAttribute("showVideoTitle"),showInfoCard:"false"!=e.getAttribute("showInfoCard")&&null!=e.getAttribute("showInfoCard"),autoPlayMute:"false"!=e.getAttribute("autoPlayMute"),queueEnable:"false"!=e.getAttribute("queueEnable"),queueEnableNext:"false"!=e.getAttribute("queueEnableNext"),pipAtStart:"false"!=e.getAttribute("pipAtStart")&&null!=e.getAttribute("pipAtStart"),noStp:"false"!=e.getAttribute("noStp")&&null!=e.getAttribute("noStp"),noPip:"false"!=e.getAttribute("noPip")&&null!=e.getAttribute("noPip"),scrollToPause:"false"!=e.getAttribute("scrollToPause")&&null!=e.getAttribute("scrollToPause"),stpSound:"false"!=e.getAttribute("stpSound")&&null!=e.getAttribute("stpSound"),playerStyleEnable:"false"!=e.getAttribute("playerStyleEnable")&&null!=e.getAttribute("playerStyleEnable"),playerStyleColor:e.getAttribute("playerStyleColor")?e.getAttribute("playerStyleColor"):null},!0===this.debugMode&&console.log("%c DM Player Params: ","background: #56C7FF; color: #232323",this.playerParams),document.dispatchEvent(this.playerExtracted)},e.prototype.prepareSearchParams=function(){var e=this.findKeywords(this.playerParams.keywordsSelector);this.searchParams={fields:this.playerParams.showInfoCard?"id,title,description,owner.avatar_190_url":"id,title",limit:1,sort:this.playerParams.sort},"relevance"===this.playerParams.sort&&(this.searchParams.search=e?e.sort((function(e,t){return t.length-e.length})).slice(0,this.playerParams.maxWordSearch).join(" "):""),this.playerParams.searchInPlaylist||(this.searchParams.private=0,this.searchParams.flags="no_live,exportable"+(this.playerParams.owners.length>0?"":",verified"),this.searchParams.longer_than=.35,this.playerParams.owners&&(this.searchParams.owners=this.playerParams.owners),this.playerParams.category&&(this.searchParams.channel=this.playerParams.category),this.playerParams.excludeIds&&(this.searchParams.exclude_ids=this.playerParams.excludeIds)),this.playerParams.language&&(this.searchParams.language=this.playerParams.language),document.dispatchEvent(this.searchParamsReady)},e.prototype.htmlEntities=function(e){return String(e).replace(/&/g,"%26").replace(/=/g,"%3d")},e.prototype.loadDmPlayer=function(){var e=this.rootEls[0],t=document.createElement("div"),r="";""===this.playerParams.adsParams?r+="ads_params=contextual":r+="ads_params="+this.htmlEntities(this.playerParams.adsParams),""!==this.playerParams.syndication&&(r+="&syndication="+this.playerParams.syndication),!0!==this.playerParams.controls&&(r+="&controls="+this.playerParams.controls),t.setAttribute("class","dailymotion-cpe"),t.setAttribute("video-id",this.videoParams.id),t.setAttribute("query-string",r),!0===this.playerParams.pipAtStart&&t.setAttribute("pip-at-start",""),!0===this.playerParams.noStp&&t.setAttribute("no-stp",""),!0===this.playerParams.noPip&&t.setAttribute("no-pip",""),!1===this.playerParams.queueEnable&&t.setAttribute("no-queue",""),!1===this.playerParams.queueEnableNext&&t.setAttribute("no-autonext",""),!1!==this.playerParams.searchInPlaylist&&t.setAttribute("Playlist-id",this.playerParams.searchInPlaylist),null!==e.getAttribute("width")&&(this.playerParams.width=Number(e.getAttribute("width")),t.setAttribute("width",e.getAttribute("width"))),null!==e.getAttribute("height")&&(this.playerParams.height=Number(e.getAttribute("height")),t.setAttribute("height",e.getAttribute("height")));var a=this.playerParams.cpeId[0];/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(a=this.playerParams.cpeId[1]?this.playerParams.cpeId[1]:this.playerParams.cpeId[0]);var n={};!0===this.playerParams.scrollToPause&&(n.scroll_to_pause=!0),!0===this.playerParams.stpSound&&(n.stp_sound=!0),!0===this.playerParams.playerStyleEnable&&(n.player_style_enable=!0),null!==this.playerParams.playerStyleColor&&(n.player_style_color=this.playerParams.playerStyleColor);var i,o,s,l,c,u,d,p,m=new Date;if(null!==this.playerParams.preVideoTitle){var h=this.setPreVideoTitle(this.playerParams.preVideoTitle);e.appendChild(h)}if(e.appendChild(t),i=window,o=document,s="script",l="cpe",c=a,u=n,i.WDMObject=l,i[l]=i[l]||function(){(i[l].q=i[l].q||[]).push(arguments)},i[l].l=1*m,i[l].i=c,i[l].f=u,i[l].g=void 0,(d=o.createElement(s)).async=1,d.src="//api.dmcdn.net/pxl/cpe/client.min.js",(p=o.getElementsByTagName(s)[0]).parentNode.insertBefore(d,p),!0===this.playerParams.showVideoTitle){var f=this.setVideoTitle(this.videoParams.title);e.appendChild(f)}if(!0===this.playerParams.showInfoCard){var y=this.setInfoCard(this.videoParams);e.appendChild(y)}},e.prototype.setVideo=function(e){this.videoParams=e,document.dispatchEvent(this.apiReady)},e.prototype.setPreVideoTitle=function(e){var t=document.createElement("p");return t.innerHTML=e,t.className="dm__pre-video-title",t},e.prototype.setVideoTitle=function(e){var t=document.createElement("p");return t.innerHTML=e,t.className="dm__video-title",t},e.prototype.setInfoCard=function(e){var t=document.createElement("div");t.className="dm__info-card";var r=document.createElement("div");r.className="dm__text-wrapper";var a=document.createElement("p");a.innerHTML=e.title,a.className="dm__video-title";var n=document.createElement("p");n.innerHTML=e.description,n.className="dm__video-desc",r.append(a),r.append(n);var i=document.createElement("img");return i.src=e["owner.avatar_190_url"],i.className="dm__owner-ava",t.append(r),t.append(i),t},e.prototype.searchVideo=function(){var e=this;!0===this.debugMode&&console.log("%c DM related ","background: #56C7FF; color: #232323","Search: "+this.searchParams.search);var t=Object.entries(this.searchParams).map((function(e){var t=e[0],r=e[1];return encodeURIComponent(t)+"="+encodeURIComponent(r)})).join("&"),r="https://api.dailymotion.com/"+(this.playerParams.searchInPlaylist?"playlist/"+this.playerParams.searchInPlaylist+"/videos":"videos")+"?"+t;fetch(r).then((function(e){return e.json()})).then((function(t){t.total>0?e.setVideo(t.list[0]):(e.searchParams.search=e.searchParams.search.substring(0,e.searchParams.search.lastIndexOf(" ")),e.searchParams.search.split(" ").length>=e.playerParams.minWordSearch&&e.searchParams.search.length>0?e.searchVideo():(!0===e.debugMode&&console.log("%c DM related ","background: #56C7FF; color: #232323","Can not find related video. Fallback video used."),e.getFallbackVideo()))}))},e.prototype.getFallbackVideo=function(){var e=this,t=Math.floor(Date.now()/1e3),r="https://api.dailymotion.com/"+(this.playerParams.searchInPlaylist?"playlist/"+this.playerParams.searchInPlaylist+"/videos?":"videos?owners="+this.playerParams.owners)+"&created_after="+(t-2592e3)+"&sort=random&limit=1&fields="+this.searchParams.fields,a=this;fetch(r).then((function(e){return e.json()})).then((function(t){t.list.length>0?a.setVideo(t.list[0]):!0===e.debugMode&&console.warn("DM related Unable to find a fallback video")}))},e.prototype.videoEvents=function(){window.addEventListener("cpeready",(function(e){e.detail.players[0]}))},e.prototype.findKeywords=function(e){var t=[""];if(null!==e){var r=document.querySelector(e);t=this.sanitizeKeywords(r.getAttribute("content"))}else null===e&&void 0!==document.getElementsByTagName("h1")[0]&&(t=this.sanitizeKeywords(document.getElementsByTagName("h1")[0].textContent));return t},e.prototype.sanitizeKeywords=function(e){var t=this;return e.replace(/[^- \u3131-\uD79D a-zA-Z0-9 \u00C0-\u00FF \u0900-\u097F \u0153]/g," ").split(" ").filter((function(e){return e.length>=t.playerParams.minWordLength}))},e}(),i=function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((a=a.apply(e,t||[])).next())}))},o=function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function s(e,t,r,a){return void 0===t&&(t=50),void 0===r&&(r=1/0),void 0===a&&(a=""),i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,new Promise((function(n,i){var o=0,s=setInterval((function(){var l=e(),c=o>r||l;o+=t,l?(n(),clearInterval(s)):c&&(i(new Error("waitFor(): "+a)),clearInterval(s))}),t)}))]}))}))}var l=function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};(function(e,t,r,a){new(r||(r=Promise))((function(n,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((a=a.apply(e,t||[])).next())}))})(void 0,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return[4,s((function(){return document.querySelectorAll(".dm-player").length>0}),500,2e3,"Timeout to get DM placeholder")];case 1:return t.sent(),e=document.querySelectorAll(".dm-player"),new n(e),[2]}}))}))}]);
//# sourceMappingURL=dm-ce.min.js.map